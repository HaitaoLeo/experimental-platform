machine:
  services:
    - docker

checkout:
  post:
    - git submodule sync
    - git submodule update --init

dependencies:
  override:
    - npm install -g mustache

test:
  override:
    - "echo 'TODO: Insert some tests here?'"

deployment:
  release:
    branch: "*"
    commands:
      - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
      - ./build.sh
      # TODO: trigger all integration tests
      - DEPLOY=yes ./build.sh

notify:
  webhooks:
    - url: $WEBHOOK_URL
